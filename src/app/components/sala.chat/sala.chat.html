@if (isAuthenticated) {
    <button class="chat-button" (click)="toggleChat()">
        ğŸ’¬
    </button>
}

@if (isChatOpen) {
    <div class="chat-overlay" (click)="closeChat()">
        <div class="chat-box" (click)="$event.stopPropagation()">
        
        <div class="chat-header">
            <h3>Chat Global</h3>
            <button (click)="closeChat()">âœ•</button>
        </div>

        <div class="chat-messages" #messagesContainer>
            @if (messages.length === 0) {
            <p>No hay mensajes</p>
            }
            
            @for (message of messages; track message.id) {
            <div [class]="isOwnMessage(message) ? 'message own' : 'message'">
                <strong>{{ isOwnMessage(message) ? 'TÃº' : message.username }}</strong>
                <span>{{ formatTime(message.created_at) }}</span>
                <p>{{ message.message }}</p>
            </div>
            }
        </div>

        <div class="chat-input">
            <input 
            type="text" 
            [(ngModel)]="newMessage"
            (keypress)="onKeyPress($event)"
            placeholder="Escribe un mensaje...">
            <button (click)="sendMessage()" [disabled]="!newMessage.trim()">
            Enviar
            </button>
        </div>

        </div>
    </div>
}